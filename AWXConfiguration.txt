systemctl enable firewalld
systemctl start firewalld

Allow the server to use the HTTP protocol

firewall-cmd --add-service=http --permanent;firewall-cmd --add-service=https --permanent
systemctl restart firewalld

Install the EPEL repository.
sudo yum install epel-release
yum install http://download.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-5.noarch.rpm


Install the prerequisite packages.

sudo yum install mariadb-server
yum install -y rabbitmq-server wget memcached nginx ansible

Installing and configuring Ansible and AWX packages

wget https://copr.fedorainfracloud.org/coprs/mrmeee/awx/repo/epel-7/mrmeee-awx-epel-7.repo
cp mrmeee-awx-epel-7.repo /etc/yum.repos.d/awx-rpm.repo
yum install -y awx
/usr/pgsql-9.6/bin/postgresql96-setup initdb

Enable and start RabbitMQ 

systemctl enable rabbitmq-server
systemctl start rabbitmq-server

Enable and start PostgreSQL

systemctl enable postgresql-9.6
systemctl start postgresql-9.6

Enable and start Memcached.

systemctl enable memcached
systemctl start memcached

Add a user to the PostgreSQL server.

sudo -u postgres createuser -S awx
! ignore the error (could not change directory to "/root": Permission denied)

Create a database in PostgreSQL.

sudo -u postgres createdb -O awx awx
ignore the error (could not change directory to "/root": Permission denied)

Import the necessary data to the database for initializing.

sudo -u awx /opt/awx/bin/awx-manage migrate

Initialize the configuration for AWX.
echo "from django.contrib.auth.models import User; User.objects.create_superuser('admin', 'root@localhost', 'password')" | sudo -u awx /opt/awx/bin/awx-manage shell
sudo -u awx /opt/awx/bin/awx-manage create_preload_data
sudo -u awx /opt/awx/bin/awx-manage provision_instance --hostname=$(hostname)
sudo -u awx /opt/awx/bin/awx-manage register_queue --queuename=tower --hostnames=$(hostname)


Configure Nginx.
cd /etc/nginx/
cp nginx.conf nginx.conf.bkp

Replace the earlier version of nginx.conf with the new version.
wget https://raw.githubusercontent.com/cupofcaffeine/ansible/working_one/nginx.conf

Copy the file to /etc/nginx.

cp nginx.conf /etc/nginx/nginx.conf
systemctl enable nginx
systemctl start nginx

Start and enable the AWX services.

systemctl enable awx-cbreceiver
systemctl start awx-cbreceiver
systemctl enable awx-celery-beat
systemctl start awx-celery-beat
systemctl enable awx-celery-worker
systemctl start awx-celery-worker
systemctl enable awx-channels-worker
systemctl start awx-channels-worker
systemctl enable awx-daphne
systemctl start awx-daphne
systemctl enable awx-web
systemctl start awx-web

